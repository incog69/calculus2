\documentclass{ximera}

\input{../preamble.tex}

\outcome{Understand what a slope field is.}
\outcome{Understand what a slope field tells us about a differential equation.}
\outcome{Define an autonomous differential equation.}
\outcome{Understand and use Euler's method.}
\outcome{Sketch slope fields.}
\outcome{Find equilibrium solutions.}

\title[Dig-In:]{Slope fields and Euler's method}

\begin{document}
\begin{abstract}
We describe numerical and graphical methods for understanding
differential equations.
\end{abstract}
\maketitle


\section{Slope fields}

We cannot (yet!) solve the differential equation
\[
y' = x+y
\]
However, from the equation alone, we can describe some facts about the
solution.

\begin{question}
  Consider the solution $y$ to the differential equation $y'=x+y$
  which passes through the point $(1,2)$.  Is $y$ increasing or
  decreasing at $x=1$?
  \begin{prompt}
  \begin{multipleChoice}
    \choice[correct]{increasing}
    \choice{decreasing}
  \end{multipleChoice}
  \end{prompt}
  \begin{hint}
    By definition, a solution to this differential equation which
    passes through $(1,2)$ must have $y(1)=2$, and
    \begin{align*}
      y'(1) &= 1+y(1)\\
      &=1+2\\
      &=3.
    \end{align*}
    This is positive, so the function is increasing at $x=1$.
  \end{hint}
\end{question}
In fact, we can say more. The differential equation
\[
y' = x+y
\]
tells us the \textbf{slope} of any solution passing through a given
point.
\begin{question}
  Consider the solution $y$ to the differential equation $y'=x+y$
  which passes through the point $(1,-2)$. What is the slope of the
  solution $y$ at $x=1?$
    \begin{hint}
    By definition, a solution to this differential equation which
    passes through $(1,-2)$ must have $y(1)=-2$, and
    \begin{align*}
      y'(1) &= 1+y(-1)\\
      &= 1-2=-1.
    \end{align*}
    Hence the slope is $-1$ at $x=1$.
    \end{hint}
    \begin{prompt}
      The slope of $y$ at $x=1$ is $\answer{-1}$.
    \end{prompt}
\end{question}

Given a differential equation, say $y'=x+y$, we can pick points in the
plane and compute what the slope of a solution at those points will
be. Repeating this process, we can generate a \textit{slope field}.
The slope field for the differential equation $y' = x+y$ looks like
this:
\begin{image}
{\def\length{sqrt(1+(x+y)^2)}
\begin{tikzpicture}
  \begin{axis}[
      xmin=-3, xmax=3,ymin=-3,ymax=3,domain=-3:3,view={0}{90},
      axis lines =center, xlabel=$x$, ylabel=$y$,
      every axis y label/.style={at=(current axis.above origin),anchor=south},
      every axis x label/.style={at=(current axis.right of origin),anchor=west},
      axis on top,
    ] 
    \addplot3 [penColor, quiver={u={1/\length}, v={(x+y)/(\length)},scale arrows=.2},samples=20] {0};
]  \end{axis}
\end{tikzpicture}}
\end{image}

Let's be explicit:
\begin{definition}
  A \dfn{slope field}, also called a \dfn{direction field}, is a
  graphical aid for understanding a differential equation, formed by:
  \begin{itemize}
	\item Choosing a grid of points.
	\item At each point, computing the slope given by the
          differential equation, using the $x$ and $y$-values of the
          point.
	\item At each point, drawing a short line segment with that
          slope.
\end{itemize}
\end{definition}

Here is the slope field for the differential equation $y'=x+y$, with a
few solutions of the differential equation also graphed.

\begin{image}
{\def\length{sqrt(1+(x+y)^2)}
\begin{tikzpicture}
  \begin{axis}[
      xmin=-3, xmax=3,ymin=-3,ymax=3,domain=-3:3,view={0}{90},
      axis lines =center, xlabel=$x$, ylabel=$y$,
      every axis y label/.style={at=(current axis.above origin),anchor=south},
      every axis x label/.style={at=(current axis.right of origin),anchor=west},
      axis on top,
    ] 
    \addplot3 [penColor, quiver={u={1/\length}, v={(x+y)/(\length)},scale arrows=.2},samples=20] {0};
    \addplot[penColor,very thick]{e^x-x-1};
    \addplot[penColor,very thick]{.2*e^x-x-1};
    \addplot[penColor,very thick]{-e^x-x-1};
    \addplot[penColor,very thick]{-.2*e^x-x-1};
    \addplot[penColor,very thick]{-3*e^x-x-1};
    \addplot[penColor,very thick]{2*e^x-x-1};
    \addplot[penColor2,very thick]{-x-1};
]  \end{axis}
\end{tikzpicture}}
\end{image}
Notice that the slope field suggests one solution to this differential
equation, which is a straight line.

\begin{question}
  Of the solutions shown in the slope field above, what is the formula
  for the linear solution?
  \begin{prompt}
    \[
    y = \answer{-1-x}
    \]
  \end{prompt}
\end{question}



\section{Autonomous differential equations}


Consider the following differential equations
\[
y' = x^3,\qquad y'=(y+1)(y-2), \qquad y'= x+y.
\]

The first differential equation, $y' = x^3$, is rather easy to solve,
we simply integrate both sides. This type of differential equation is
called a \dfn{pure-time differential equation}. Pure-time differential
equations express the derivative of the solution explicitly as a
function of an independent variable. We can symbolically describe a
pure-time differential equation as
\[
\dd[y]{x} = f(x).
\]

On the other hand, the second differential equation, $y'=(y+1)(y-2)$
does not involve the independent variable, $x$, at all!  Such
differential equations are called \textit{autonomous} differential
equations.

\begin{definition}
  A differential equation that does not involve the independent
  variable is called an \dfn{autonomous differential equation}. We can
  symbolically write
  \[
  \dd[y]{x} = f(y)
  \]
  to express an autonomous differential equation.
\end{definition}

Finally the third differential equation, $y'= x+y$, expresses $y'$ as
a function of both $y$ and the independent variable $x$. Such a
differential equation is called a \dfn{nonautonomous differential
  equation}. We can symbolically describe  a nonautonomous differential equation as
\[
\dd[y]{x} = F(x,y).
\]
\begin{question}
  Which of the following are autonomous differential equations?
  \begin{selectAll}
    \choice[correct]{$f' = 7\cdot f$}
    \choice{MORE}
  \end{selectAll}
\end{question}

Since autonomous differential equations \textbf{only} depend on the
function's value their behavior does not depend on the independent
variable,

\begin{question}
  SLOPE FIELD ID
\end{question}


\begin{question}
Consider the differential equation $y' = (y+1)(2-y)$, whose slope
field is given below.  Which of the following statements appear to be
true?

\begin{image}
{\def\length{sqrt(1+((y+1)*(2-y))^2)}
\begin{tikzpicture}
  \begin{axis}[
      xmin=-3, xmax=3,ymin=-3,ymax=3,domain=-3:3,view={0}{90},
      axis lines =center, xlabel=$x$, ylabel=$y$,
      every axis y label/.style={at=(current axis.above origin),anchor=south},
      every axis x label/.style={at=(current axis.right of origin),anchor=west},
      axis on top,
    ] 
    \addplot3 [penColor, quiver={u={1/\length}, v={((y+1)*(2-y))/(\length)},scale arrows=.2},samples=20] {0};
]  \end{axis}
\end{tikzpicture}}
\end{image}

\begin{multipleChoice}
	\choice[correct]{The solution passing through the origin has $\lim_{x \to \infty} f(x) = 2$}
	\choice{The solution passing through $(0,3)$ has $\lim_{x \to \infty} f(x) = \infty$}
	\choice[correct]{The solution passing through $(0,-3)$ is always decreasing}
	\choice[correct]{There are two solutions which are constant functions}
	\choice{Every solution has a vertical tangent line at $x=0$}
\end{multipleChoice}
\end{question}

The constant functions $f(x) = -1$ and $f(x) =2$ are solutions to this
differential equation.  In fact, for any autonomous differential
equation $y' = A(y)$, where $A$ is a function of $y$, if $A(C) = 0$,
then $y = C$ will be a constant solution to the differential equation.
These constant solutions are also known as \dfn{equilibrium}
solutions.

\begin{question}
Consider the autonomous differential equation $y'=\cos(y)$.  Which of the following are equilibrium solutions?

\begin{multipleChoice}
\choice{$0$}
\choice[correct]{$\frac{\pi}{2}$}
\choice{$\pi$}
\end{multipleChoice}
\end{question}




In Figure~\ref{figure:slopeFieldExer}, we see a slope field for a
differential equation. If $f(2)=4$, what is your best guess for
$f(5)$?

$\answer[given]{3}$

In Figure~\ref{figure:slopeFieldExer}, we see a slope field for a
differential equation. If $f(1)=1.1$, what is your best guess for
$f(5)$?
$\answer[given]{3}$


{\def\length{sqrt(1+(-y^2+4*y-3)^2)}
\begin{tikzpicture}
  \begin{axis}[
      xmin=0, xmax=5,ymin=0,ymax=5,domain=0:5,view={0}{90},
      axis lines =center, xlabel=$x$, ylabel=$y$,
      every axis y label/.style={at=(current axis.above origin),anchor=south},
      every axis x label/.style={at=(current axis.right of origin),anchor=west},
      axis on top,
    ] 
    \addplot3 [penColor, quiver={u={1/\length}, v={(-y^2 +4*y - 3)/(\length)},scale arrows=.2},samples=20] {0};
  \end{axis}
\end{tikzpicture}}




















\section{Euler's Method}

In science and mathematics, finding exact solutions to differential equations is not always possible.
We have already seen that slope fields give us a powerful way to understand the qualitative features of solutions.
Sometimes we need a more precise quantitative understanding, i.e. we would like numerical approximations of the solutions.

\begin{example}
Suppose you have set up the following differential equation
\[
y' = x+y
\]

While one can solve this differential equation, we cannot solve it
\textit{yet}. 

If we know that $f$ solves this differential equation, and $f(0) = 1$, how might we go about approximating $f(1)$?

One idea is to repeatedly use linear approximation.

Let us approximate just using the two subintervals $[0,\frac{1}{2}]$ and $[\frac{1}{2},1]$.

Since $f'(0) = \answer{1}$, we know that $f(\frac{1}{2}) \approx 1+\answer{1} \cdot \frac{1}{2} = \answer{\frac{3}{2}}$ by linear approximation.

But now, we have $f'(\frac{1}{2}) \approx \frac{1}{2}+\frac{3}{2} = 2$ so $f(1) \approx  f(\frac{1}{2})+\frac{1}{2} \cdot 2 \approx \answer{\frac{5}{2}}$.

This approximation could be improved by using more subintervals
\end{example}

We will now formalize the method of using repeated linear approximation to approximate solutions to differential equations, and call it \dfn{Euler's Method}.

\begin{definition}[Euler's Method]
Consider a differential equation of the form $y' = R(x,y)$, where $R$ is a function of two variables.

If $f$ satisfies the initial value problem $f(a) = b$, and we want to approximate $f(T)$, then we follow this procedure:

\begin{itemize}
	\item Decide how many subintervals you want to divide the interval $[a,T]$ into.  Call this number $n$.
	\item Let $x_k = a+\frac{T-a}{n}k$ for $k=0,1,2,...,n-1$ be the left endpoints of the subintervals.
	\item Let $y_0 = b$
	\item Iteratively define $y_{k+1} = y_k+A(x_k,y_k)\frac{T-a}{n}$ 
\end{itemize}

Then $f(x_k) \approx y_k$, and so $f(T) \approx y_{n}$.

\end{definition}

BADBAD Picture HERE???



\begin{question}
$f$ is a solution to 

\[
y'=x+y
\]

with initial condition $f(0)=1$.  We want to approximate $f(2)$.  

Using the notation from the definition, we have 

\[
A(x,y) = \answer{x+y}
\]
Fill out the following table for Euler's method using $4$ subintervals.

	\[
\begin{array}{l|l|l}
k & x_k & y_k \\ \hline
0 & 0   & 1 \\
1 & 0.5 & \answer{1.5} \\
2 & \answer{1} & \answer{2.5}  \\
3 & 1.5 & 4.25 \\
4 & 2 & \answer{7.125} \\
\end{array}
\]

	Thus $f(2) \approx \answer{7.125}$

\end{question}	


\end{document}
