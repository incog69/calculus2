\documentclass{ximera}

\input{../preamble.tex}

\outcome{Compute Taylor polynomials.}
\outcome{Use Taylor's theorem to estimate the error of a Taylor polynomial.}
\outcome{Determine the maximum error between a function and a given
  Taylor polynomial.}

\title[Dig-In:]{Approximating functions with polynomials}

\begin{document}
\begin{abstract}
We can approximate smooth functions with polynomials.
\end{abstract}
\maketitle


\section{Polynomials can approximate some functions}

In our study of mathematics, we've found that some functions are
easier to work with than others. For instance, if you are doing
calculus, typically polynomials are ``easy'' to work with because they
are easy to differenitate and integrate. Other functions, like
\[
f(x) =
\begin{cases}
  \frac{\sin(x)}{x} &\text{if $x\ne 0$}\\
  1 &\text{if $x=0$}
\end{cases}
\]
are more difficult to work with. However, check this out: There are
polynomials that mimic the behavior of $f$ near zero,
\begin{image}
  \begin{tikzpicture}
    \begin{axis}[
        xmin=-6.75,xmax=6.75,ymin=-1.5,ymax=1.5,
        axis lines=center,
        xtick={-6.28, -4.71, -3.14, -1.57, 0, 1.57, 3.142, 4.71, 6.28},
        xticklabels={$-2\pi$,$-3\pi/2$,$-\pi$, $-\pi/2$, $0$, $\pi/2$, $\pi$, $3\pi/2$, $2\pi$},
        ytick={-1,1},
        %ticks=none,
        width=6in,
        height=3in,
        unit vector ratio*=1 1 1,
        xlabel=$x$, ylabel=$y$,
        every axis y label/.style={at=(current axis.above origin),anchor=south},
        every axis x label/.style={at=(current axis.right of origin),anchor=west},
      ]        
      \addplot [very thick, penColor, samples=100,smooth, domain=(-6.75:6.75)] {sin(deg(x))/x};
      \addplot [very thick, penColor2, samples=100,smooth, domain=(-6.75:6.75)] {1-x^2/6 + x^4/120};
      %\addplot[color=penColor,fill=white,only marks,mark=*] coordinates{(0,1)};  %% open hole          
    \end{axis}
  \end{tikzpicture}
\end{image}
Above we see a graph of $f$ along with the polynomial
\[
1-\frac{x^2}{6}+\frac{x^4}{120}.
\]
As we see, this polynomial approximates $f$ very well near zero. This
leads us to a question:


\subsection{How do we produce approximating polynomials?}

Cutting straight to the point, the approximating polynomials we'll
discuss are called \textit{Taylor polynomials} and \textit{Maclaurin
  polynomials}.

\begin{definition}[Taylor/Maclaurin Polynomial]
  Let $f$ be a function whose first $n$ derivatives exist at $x=c$.
  \begin{itemize}
  \item The \dfn{Taylor polynomial} of degree $n$ of $f$ at $x=c$ is
    \[
    p_n(x) = f(c) + f'(c)(x-c) + \frac{f''(c)}{2!}(x-c)^2+\frac{f'''(c)}{3!}(x-c)^3+\cdots+\frac{f^{(n)}(c)}{n!}(x-c)^n.
    \]
  \item A special case of the Taylor polynomial is the Maclaurin
    polynomial, where $c=0$. That is, the \dfn{Maclaurin polynomial}
    of degree $n$ of $f$ is
    \[
    p_n(x) = f(0) + f'(0)x +\frac{f''(0)}{2!}x^2+\frac{f'''(0)}{3!}x^3+\cdots+\frac{f^{(n)}(0)}{n!}x^n.
    \]
  \end{itemize}
  We say these polynomials have a \dfn{center} of $x=c$, and so
  Maclaurin polynomials are Taylor polynomials centered at
  zero.
\end{definition}

\begin{question}
  Consider $f(x) = e^x$. Which of the following is a Maclaurin
  polynomial for $e^x$?
  \begin{selectAll}
    \choice{$1+x+x^2+x^3+x^4$}
    \choice[correct]{$1+x$}
    \choice[correct]{$1+x+\frac{x^2}{2!} + \frac{x^3}{3!}+ \frac{x^4}{4!}$}
    \choice{$1-\frac{x^2}{2!} +\frac{x^4}{4!}$}
    \choice{$x-\frac{x^3}{3!}$}
    \choice[correct]{$1$}
  \end{selectAll}
  Check out a plot of $e^x$ along with the plots of the correct answers above:
  \begin{image}
    \begin{tikzpicture}
      \begin{axis}[
          xmin=-5,xmax=4,ymin=-1,ymax=10,
          axis lines=center,
          %ticks=none,
          width=6in,
          height=3in,
          %unit vector ratio*=1 1 1,
          xlabel=$x$, ylabel=$y$,
          every axis y label/.style={at=(current axis.above origin),anchor=south},
          every axis x label/.style={at=(current axis.right of origin),anchor=west},
        ]        
        \addplot [very thick, penColor, samples=100,smooth] {e^x};
        \addplot [very thick, penColor2, samples=100,smooth] {1};
        \addplot [very thick, penColor3, samples=100,smooth] {1+x};
        \addplot [very thick, penColor4, samples=100,smooth] {1+x+x^2/2+x^3/6+x^4/24};
      \end{axis}
    \end{tikzpicture}
  \end{image}
\end{question}

\begin{question}
  Consider $f(x) = \ln(x)$. Which of the following is a Taylor
  polynomial centered at $1$for $f$?
    \begin{selectAll}
    \choice[correct]{$x-1$}
    \choice{$1+x$}
    \choice{$1+x+\frac{x^2}{2!} + \frac{x^3}{3!}+ \frac{x^4}{4!}$}
    \choice[correct]{$(x-1)-\frac{(x-1)^2}{2}+\frac{(x-1)^3}{3}$}
    \choice[correct]{$(x-1)-\frac{(x-1)^2}{2}+\frac{(x-1)^3}{3}-\frac{(x-1)^4}{4}$}
    \choice{$1$}
  \end{selectAll}
  Check out a plot of $\ln(x)$ along with the plots of the correct answers above:
  \begin{image}
    \begin{tikzpicture}
      \begin{axis}[
          xmin=-1,xmax=4,ymin=-5,ymax=5,
          axis lines=center,
          %ticks=none,
          width=6in,
          height=3in,
          %unit vector ratio*=1 1 1,
          xlabel=$x$, ylabel=$y$,
          every axis y label/.style={at=(current axis.above origin),anchor=south},
          every axis x label/.style={at=(current axis.right of origin),anchor=west},
        ]        
        \addplot [very thick, penColor, samples=100,smooth,domain=.01:4] {ln(x)};
        \addplot [very thick, penColor2, samples=100,smooth] {(x-1)};
        \addplot [very thick, penColor3, samples=100,smooth] {(x-1)-(1/2) *(x-1)^2+1/3* (x-1)^3};
        \addplot [very thick, penColor4, samples=100,smooth] {(x-1)-(1/2) *(x-1)^2+(1/3) * (x-1)^3-(1/4) * (x-1)^4};  
      \end{axis}
    \end{tikzpicture}
  \end{image}
\end{question}

\begin{example}
  Compute the Maclaurin polynomial of degree $4$ for $f(x) =
  \frac{1}{1-x}$.
  \begin{explanation}
    To do this, we set $f(x) =\frac{1}{1-x}$ and use the following formula:
    \[
    p_n(x) = f(0) + f'(0)x +\frac{f''(0)}{2!}x^2+\frac{f'''(0)}{3!}x^3+\frac{f^{(4)}(0)}{4!}x^4
    \]
    So we must compute the first four derivatives of $f$
    \begin{align*}
      f(x) &= \frac{1}{1-x},\\
      f'(x) &= \frac{1}{(1-x)^2},\\
      f''(x) &= \frac{2}{(1-x)^3},\\
      f'''(x) &= \frac{2\cdot 3}{(1-x)^4},\\
      f^{(4)}(x) &= \frac{2\cdot 3\cdot 4}{(1-x)^5},
    \end{align*}
    and evaluate each of these at $x=0$. Write with me
    \begin{align*}
      f(0) &= 1,\\
      f'(0) &= 1,\\
      f''(0) &= 2,\\
      f'''(0) &=2\cdot 3,\\
      f^{(4)}(0) &= 2\cdot 3\cdot 4.
    \end{align*}
    Now plugging this into our formula above we see
    \[
    p_4 = 1 + x + x^2 + x^3 + x^4.
    \]
    Finally, let's see a graph of $p_4$ and $f$:
      \begin{image}
    \begin{tikzpicture}
      \begin{axis}[
          xmin=-1.5,xmax=1.5,ymin=-1,ymax=5,
          axis lines=center,
          %ticks=none,
          width=6in,
          height=3in,
          %unit vector ratio*=1 1 1,
          xlabel=$x$, ylabel=$y$,
          every axis y label/.style={at=(current axis.above origin),anchor=south},
          every axis x label/.style={at=(current axis.right of origin),anchor=west},
        ]        
        \addplot [very thick, penColor, samples=100,smooth,domain=-1.5:.99] {1/(1-x)};
        \addplot [very thick, penColor2, smooth,domain=-1.5:.99] {1+x+x^2+x^3+x^4};
      \end{axis}
    \end{tikzpicture}
  \end{image}
  \end{explanation}
\end{example}


\begin{example}
Find the $n$th Taylor polynomial of $y=\ln x$ centered at $x=1$.
\begin{explanation}
  To do this, we set $f(x) =\ln(x)$ and use the following formula:
    \[
    p_n(x) = f(0) + f'(0)x +\frac{f''(0)}{2!}x^2+\frac{f'''(0)}{3!}x^3+\cdots+\frac{f^{(n)}(0)}{n!}x^n
    \]
    So we must compute the first several derivatives of $f$
    \begin{align*}
      f(x) &= \ln(x),\\
      f'(x) &= \frac{1}{x},\\
      f''(x) &= \frac{-1}{x^2},\\
      f'''(x) &= \frac{2}{x^3},\\
      f^{(4)}(x) &= \frac{-2\cdot 3}{x^4},\\
      f^{(5)}(x) &= \frac{2\cdot 3\cdot 4}{x^5},\\
      &\vdots\\
      f^{(n)}(x) &= \frac{(-1)^{n-1}\cdot (n-1)!}{x^n},
    \end{align*}
    and evaluate each of these at $x=1$. Write with me
    \begin{align*}
      f(1) &= 0,\\
      f'(1) &= 1,\\
      f''(1) &= -1,\\
      f'''(1) &= 2,\\
      f^{(4)}(1) &= -6,\\
      f^{(5)}(1) &= 24,\\
      &\vdots\\
      f^{(n)}(1) &= (-1)^{n-1}\cdot (n-1)!
    \end{align*}
    Now plugging this into our formula above we see
    \[
    p_n = BADBADBADBAD
    \]
    Finally, let's see a graph of $p_4$ and $f$:
      \begin{image}
    \begin{tikzpicture}
      \begin{axis}[
          xmin=-1.5,xmax=1.5,ymin=-1,ymax=5,
          axis lines=center,
          %ticks=none,
          width=6in,
          height=3in,
          %unit vector ratio*=1 1 1,
          xlabel=$x$, ylabel=$y$,
          every axis y label/.style={at=(current axis.above origin),anchor=south},
          every axis x label/.style={at=(current axis.right of origin),anchor=west},
        ]        
        \addplot [very thick, penColor, samples=100,smooth,domain=-1.5:.99] {1/(1-x)};
        \addplot [very thick, penColor2, smooth,domain=-1.5:.99] {1+x+x^2+x^3+x^4};
      \end{axis}
    \end{tikzpicture}
  \end{image}
\end{explanation}
\end{example}
\end{document}

\item		We begin by creating a table of derivatives of $\ln x$ evaluated at $x=1$. While this is not as straightforward as it was in the previous example, a pattern does emerge, as shown in Figure \ref{fig:taypoly2a}.
\mtable{.5}{Derivatives of $\ln x$ evaluated at $x=1$.}{fig:taypoly2a}{%
\begin{tabular}{lll}
$f(x) = \ln x $&$\Rightarrow $&$f(1) = 0$\\
$f'(x) = 1/x $&$\Rightarrow $&$f'(1) = 1$\\
$f''(x) = -1/x^2 $&$\Rightarrow $&$f''(1) = -1$\\
$f'''(x) = 2/x^3 $&$\Rightarrow $&$f'''(1) = 2$\\
$f\,^{(4)}(x) = -6/x^4 $&$\Rightarrow $&$f\,^{(4)}(1) = -6$\\
$\ \vdots $& &$\ \vdots$\\
$f\,^{(n)}(x) = $ &$\Rightarrow$ & $f\,^{(n)}(1) = $\\
$\ds \rule{0pt}{15pt}\frac{(-1)^{n+1}(n-1)!}{x^n} $ & & $(-1)^{n+1}(n-1)!$
\end{tabular}
%\begin{tabular}{l}
%{\scriptsize $f\,^{(n)}(x) = \frac{(-1)^{n+1}(n-1)!}{x^n} \Rightarrow f\,^{(n)}(1) = (-1)^{n+1}(n-1)!$}
%\end{tabular}
}

Using Definition \ref{def:taypoly}, we have \small
\begin{align*}
	p_n(x) &=	f(c) + f'(c)(x-c) + \frac{f''(c)}{2!}(x-c)^2+\frac{f'''(c)}{3!}(x-c)^3+\cdots+\frac{f\,^n(c)}{n!}(x-c)^n\\
					&= 0+(x-1)-\frac12(x-1)^2+\frac13(x-1)^3-\frac14(x-1)^4+\cdots+\frac{(-1)^{n+1}}{n}(x-1)^n.
\end{align*}
\normalsize
Note how the coefficients of the $(x-1)$ terms turn out to be ``nice.''

\item		We can compute $p_6(x)$ using our work above:
$$p_6(x) = (x-1)-\frac12(x-1)^2+\frac13(x-1)^3-\frac14(x-1)^4+\frac15(x-1)^5-\frac16(x-1)^6.$$
Since $p_6(x)$ approximates $\ln x$ well near $x=1$, we approximate $\ln 1.5 \approx p_6(1.5)$:

\begin{align*}
p_6(1.5) &= (1.5-1)-\frac12(1.5-1)^2+\frac13(1.5-1)^3-\frac14(1.5-1)^4+\cdots \\
			&\cdots +\frac15(1.5-1)^5-\frac16(1.5-1)^6\\
	&=\frac{259}{640}\\
	&\approx 0.404688.
\end{align*}
\normalsize
This is a good approximation as a calculator shows that $\ln 1.5 \approx 0.4055.$ Figure \ref{fig:taypoly2b} plots $y=\ln x$ with $y=p_6(x)$. We can see that $\ln 1.5\approx p_6(1.5)$.

\mfigure{.8}{A plot of $y=\ln x$ and its 6$^\text{th}$ degree Taylor polynomial at $x=1$.}{fig:taypoly2b}{figures/figtaypoly2b}
\item	
We approximate $\ln 2$ with $ p_6(2)$:
\begin{align*}
p_6(2) &= (2-1)-\frac12(2-1)^2+\frac13(2-1)^3-\frac14(2-1)^4+\cdots \\
			&\cdots +\frac15(2-1)^5-\frac16(2-1)^6\\
			&=	1-\frac12+\frac13-\frac14+\frac15-\frac16 \\
			&= \frac{37}{60}\\ 
			&\approx 0.616667.
\end{align*}
This approximation is not terribly impressive: a hand held calculator shows that $\ln 2 \approx 0.693147.$ The graph in Figure \ref{fig:taypoly2b} shows that $p_6(x)$ provides less accurate approximations of $\ln x$ as $x$ gets close to 0 or 2. 

Surprisingly enough, even the 20$^\text{th}$ degree Taylor polynomial fails to approximate $\ln x$ for $x>2$, as shown in Figure \ref{fig:taypoly2c}. We'll soon discuss why this is.
\mfigure{.45}{A plot of $y=\ln x$ and its 20$^\text{th}$ degree Taylor polynomial at $x=1$.}{fig:taypoly2c}{figures/figtaypoly2c}
\end{enumerate}
\vskip-1.5\baselineskip
}\\


\begin{question}
Use $p_6(x)$ to approximate the value of $\ln 1.5$.
Use $p_6(x)$ to approximate the value of $\ln 2$. 
\end{question}




You may be wondering, \textit{how} exactly Taylor polynomials and
Maclaurin polynomails approximate these functions. Here's the idea:
Suppose you have two functions $f$ and $g$. If for some specific value
$x=c$ we have that
\begin{align*}
  f(c) &= g(c)\\
  f'(c) &= g'(c)\\
  f''(c) &= g''(c)\\
  f'''(c) &= g'''(c)\\
          &\vdots
\end{align*}
then it makes sense that 
\[
f(x) = g(x)
\]
for all $x$. The Taylor and Macularin polynomials are ``cooked up'' so
that their value and the value of their derivatvies equals the value
of the related function at $x=c$. Check it out, here we see the $3$rd
Maclaurin polynomial for $f(x) = \sin(x)$:
\[
p_3(x) = x - \frac{x^3}{3!} 
\]
we see
\begin{align*}
  p_3(0) = 0 &= f(0) = \sin(0)\\
  p_3'(0) = 1 &= f'(1) = \cos(0)\\
  p_3''(0) = 0 &= f''(0) = -\sin(0)\\
  p_3'''(0) = -1 &= f'''(0) = -\cos(0)\\
  p_3^{(4)}(0) = 0 &= f^{(4)}(0) = \sin(0)\\
  p_3^{(5)}(0) = 0 &\ne f^{(5)}(0) = \cos(0)
\end{align*}
Note that in the case of sine,
\[
p_3(x) = x - \frac{x^3}{3!} 
\]
shares the function's value at $x=0$ and shares the first $4$
derivatives, though the $5$th derivative is different. Let's see a
graph to help us understand what is going on:
      \begin{image}
    \begin{tikzpicture}
      \begin{axis}[
          xmin=-6.28,xmax=6.28,ymin=-1.5,ymax=1.5,
          axis lines=center,
          %ticks=none,
          width=6in,
          height=3in,
          %unit vector ratio*=1 1 1,
          xlabel=$x$, ylabel=$y$,
          every axis y label/.style={at=(current axis.above origin),anchor=south},
          every axis x label/.style={at=(current axis.right of origin),anchor=west},
        ]        
        \addplot [very thick, penColor,smooth] {sin(deg(x))};
        \addplot [very thick, penColor2, smooth] {x-x^3/6};
      \end{axis}
    \end{tikzpicture}
      \end{image}
      We can see that $p_3$ is a good approximation for $\sin(x)$ near
      $x=0$. Next we give a method to quantify exactly how good our
      approximation is.

\section{Taylor's theorem}

Again let's get to the point by stating Taylor's theorem (which is a
generalization of the mean value theorem):

\begin{theorem}[Taylor's Theorem]\index{Taylor's Theorem}
Let $f$ be a function whose $(n+1)$th derivative exists on an interval
$I$, let $c$ be in $I$, and let $p_n$ be the $n$th Taylor polynomial
for $f$ centered at $x=c$. Then, for each $x$ in $I$, there exists $b$
between $x$ and $c$ such that
\[
f(x) = p_n(x) + R_n(x),
\]
where $R_n(x) = \frac{f^{(n+1)}(b)}{(n+1)!}(x-c)^{(n+1)}$.
\begin{image}
  \begin{tikzpicture}
    \begin{axis}[
        xmin=5.28,xmax=9.42,ymin=-.5,ymax=2.5,
        domain=5.28:9.42,
        axis lines=center,
        %ticks=none,
        xtick={6.28,8.75},
        xticklabels={$c$,$b$},
        ytickmin=1, ytickmax=0,
        width=6in,
        height=3in,
        %unit vector ratio*=1 1 1,
        xlabel=$x$, ylabel=$y$,
        every axis y label/.style={at=(current axis.above origin),anchor=south},
        every axis x label/.style={at=(current axis.right of origin),anchor=west},
      ]        
      \addplot [very thick, penColor,smooth] {1+sin(deg(x))};
      \addplot [very thick, penColor2, smooth] {1+(x-2*pi)-(x-2*pi)^3/6};
      \addplot [textColor,dashed] plot coordinates {(6.28,0) (6.28,1)};
      \addplot [textColor,dashed] plot coordinates {(8.75,0) (8.75,1.63)};
      \addplot [decoration={brace,mirror, raise=.1cm},decorate,thin] plot coordinates {(8.75,.97) (8.75,1.63)};
      \node at (axis cs: 8.97,1.25) {$R_n(x)$};
      \node at (axis cs: 8.5,2) {$f$};
      \node at (axis cs: 8.5,1.2) {$p_n$};
      
    \end{axis}
  \end{tikzpicture}   
\end{image}
Moreover,
\[
\left|R_n(x)\right| \leq \frac{M}{(n+1)!}|x-c|^{(n+1)}
\]
where $M$ is the maximum value of $|f^{(n+1)}|$ on $[c,x]$.
\end{theorem}

The first part of Taylor's theorem states that $f(x) = p_n(x) +
R_n(x)$, where $p_n(x)$ is the $n$th order Taylor polynomial and
$R_n(x)$ is the remainder, or error, in the Taylor approximation. The
second part gives bounds on how big that error can be. If the
$(n+1)$th derivative is large, the error may be large; if $x$ is far
from $c$, the error may also be large. However, the $(n+1)!$ term in
the denominator tends to ensure that the error gets smaller as $n$
increases. 


\begin{example}
  Approximate $f(x) = e^x$ with a $5$th degree polynomial at $x = 0$.
  What is the maximum error of your approximation at $x=2?$, note this
  may not be unique.
  \begin{explanation}
    To do this, we set $f(x) =e^x$ and use the following formula:
    \[
    p_n(x) = f(0) + f'(0)x +\frac{f''(0)}{2!}x^2+\cdots +\frac{f^{(5)}(0)}{5!}x^5
    \]
    So we must compute the first five derivatives of $f$
    \[
      f(x) = f'(x) = f''(x) = f'''(x) = f^{(4)}(x)  = f^{(5)}(x) = e^x
    \]
    and evaluate each of these at $x=0$. Write with me
    \[
    f(0) = f'(0) = f''(0) = f'''(0) = f^{(4)}(0)  = f^{(5)}(0) = e^0 = 1
    \]
    Now plugging this into our formula above we see
    \[
    p_5 = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + \frac{x^5}{5!}.
    \]
    Finally, let's see a graph of $p_5$ and $f$:
      \begin{image}
    \begin{tikzpicture}
      \begin{axis}[
          xmin=-5,xmax=4,ymin=-1,ymax=10,
          axis lines=center,
          %ticks=none,
          width=6in,
          height=3in,
          %unit vector ratio*=1 1 1,
          xlabel=$x$, ylabel=$y$,
          every axis y label/.style={at=(current axis.above origin),anchor=south},
          every axis x label/.style={at=(current axis.right of origin),anchor=west},
        ]        
        \addplot [very thick, penColor, samples=100,smooth] {e^x};
        \addplot [very thick, penColor2, smooth] {1+x+x^2/2+x^3/6+x^4/24+x^5/120};
      \end{axis}
    \end{tikzpicture}
      \end{image}
      To estimiate the error, we need to find a bound $M$ such that
      \[
      M >|f^{(6)}(x)|
      \]
      on the interval $[0,2]$. Since $f^{(6)}(x) = e^x$, the largest
      value will be $e^2$. Instead of computing this directly, note
      \[
      e^2 < 3^2< 9.
      \]
      Hence we can say for certanity that
      \[
      |p_n(2) - e^2| < \frac{9}{6!}\cdot(2)^6 = \frac{4}{5}.
      \]
  \end{explanation}
\end{example}
\end{document}




Taylor polynomials are used to approximate functions $f(x)$ in mainly two situations:
	\begin{enumerate}
	\item		When $f(x)$ is known, but perhaps ``hard'' to compute directly. For instance, we can define $y=\cos x$ as either the ratio of sides of a right triangle (``adjacent over hypotenuse'') or with the unit circle. However, neither of these provides a convenient way of computing $\cos 2$. A Taylor polynomial of sufficiently high degree can provide a reasonable method of computing such values using only operations usually hard--wired into a computer ($+$, $-$, $\times$ and $\div$).
	
	\item		When $f(x)$ is not known, but information about its derivatives is known. This occurs more often than one might think, especially in the study of differential equations.
	\end{enumerate}

\mnote{.8}{\textbf{Note:} Even though Taylor polynomials \emph{could} be used in calculators and computers to calculate values of trigonometric functions, in practice they generally aren't. Other more efficient and accurate methods have been developed, such as the CORDIC algorithm.}
	
In both situations, a critical piece of information to have is ``How good is my approximation?'' If we use a Taylor polynomial to compute $\cos 2$, how do we know how accurate the approximation is? 

We had the same problem when studying Numerical Integration. Theorem \ref{thm:numerical_error} provided bounds on the error when using, say, Simpson's Rule to approximate a definite integral. These bounds allowed us to determine that, for instance, using $10$ subintervals provided an approximation within $\pm .01$ of the exact value. The following theorem gives similar bounds for Taylor (and hence Maclaurin) polynomials.

\setboxwidth{65pt}
\noindent\hskip-65pt
\begin{minipage}[t]{\specialboxlength}
\theorem{thm:taylorthm}{Taylor's Theorem}
{\begin{enumerate}
\item	Let $f$ be a function whose $n+1^\text{th}$ derivative exists on an interval $I$ and let $c$ be in $I$. Then, for each $x$ in $I$, there exists $z_x$ between $x$ and $c$ such that
$$f(x) = f(c) + f'(c)(x-c) + \frac{f''(c)}{2!}(x-c)^2+ \cdots +\frac{f\,^{(n)}(c)}{n!}(x-c)^n+R_n(x),$$
where $\ds R_n(x) = \frac{f\,^{(n+1)}(z_x)}{(n+1)!}(x-c)^{(n+1)}.$
\index{Taylor Polynomial!Taylor's Theorem}\index{Taylor's Theorem}

\item		$\ds \big|R_n(x)\big| \leq \frac{\max\left|\,f\,^{(n+1)}(z)\right|}{(n+1)!}\big|(x-c)^{(n+1)}\big|$
\end{enumerate}
}
\end{minipage}
\restoreboxwidth

The first part of Taylor's Theorem states that $f(x) = p_n(x) + R_n(x)$, where $p_n(x)$ is the $n^\text{th}$ order Taylor polynomial and $R_n(x)$ is the remainder, or error, in the Taylor approximation. The second part gives bounds on how big that error can be. If the $(n+1)^\text{th}$ derivative is large, the error may be large; if $x$ is far from $c$, the error may also be large. However, the $(n+1)!$ term in the denominator tends to ensure that the error gets smaller as $n$ increases.

The following example computes error estimates for the approximations of $\ln 1.5$ and $\ln 2$ made in Example \ref{ex_taypoly2}.\\

\example{ex_taypoly3}{Finding error bounds of a Taylor polynomial}{
Use Theorem \ref{thm:taylorthm} to find error bounds when approximating $\ln 1.5$ and $\ln 2$ with $p_6(x)$, the Taylor polynomial of degree 6 of $f(x)=\ln x$ at $x=1$, as calculated in Example \ref{ex_taypoly2}. }
{\begin{enumerate}
\item	We start with the approximation of $\ln 1.5$ with $p_6(1.5)$. The theorem references an open interval $I$ that contains both $x$ and $c$. The smaller the interval we use the better; it will give us a more accurate (and smaller!) approximation of the error. We let $I = (0.9,1.6)$, as this interval contains both $c=1$ and $x=1.5$. 

The theorem references $\max\big|f\,^{(n+1)}(z)\big|$. In our situation, this is asking ``How big can the $7^\text{th}$ derivative of $y=\ln x$ be on the interval $(0.9,1.6)$?'' The seventh derivative is $y = -6!/x^7$. The largest value it attains on $I$ is about 1506. Thus we can bound the error as:

\begin{align*}
\big|R_6(1.5)\big| &\leq \frac{\max\big|f\,^{(7)}(z)\big|}{7!}\big|(1.5-1)^7\big|\\
					&\leq \frac{1506}{5040}\cdot\frac1{2^7}\\
					&\approx 0.0023.
\end{align*}

\noindent%\drawexampleline
We computed $p_6(1.5) = 0.404688$; using a calculator, we find $\ln 1.5 \approx 0.405465$, so the actual error is about $0.000778$, which is less than our bound of $0.0023$. This affirms Taylor's Theorem; the theorem states that our approximation would be within about 2 thousandths of the actual value, whereas the approximation was actually closer.

\item		We again find an interval $I$ that contains both $c=1$ and $x=2$; we choose $I = (0.9,2.1)$. The maximum value of the seventh derivative of $f$ on this interval is again about 1506 (as the largest values come near $x=0.9$). Thus 
\begin{align*}
\big| R_6(2)\big| &\leq \frac{\max\big|f\,^{(7)}(z)\big|}{7!}\big|(2-1)^7\big|\\
					&\leq \frac{1506}{5040}\cdot1^7\\
					&\approx 0.30.
\end{align*}
This bound is not as nearly as good as before. Using the degree 6 Taylor polynomial at $x =1$ will bring us within 0.3 of the correct answer. As $p_6(2)\approx 0.61667$, our error estimate guarantees that the actual value of $\ln 2$ is somewhere between $0.31667$ and $0.91667$. These bounds are not particularly useful.

In reality, our approximation was only off by about 0.07. However, we are approximating ostensibly because we do not know the real answer. In order to be assured that we have a good approximation, we would have to resort to using a polynomial of higher degree.
\end{enumerate}
\vskip-1.5\baselineskip
}\\

We practice again. This time, we use Taylor's theorem to find $n$ that guarantees our approximation is within a certain amount.\\

\example{ex_taypoly4}{Finding sufficiently accurate Taylor polynomials}{
Find $n$ such that the $n^\text{th}$ Taylor polynomial of $f(x)=\cos x$ at $x=0$ approximates $\cos 2$ to within $0.001$ of the actual answer. What is $p_n(2)$?}
{Following Taylor's theorem, we need bounds on the size of the derivatives of $f(x)=\cos x$. In the case of this trigonometric function, this is easy. All derivatives of cosine are $\pm \sin x$ or $\pm \cos x$. In all cases, these functions are never greater than 1 in absolute value. We want the error to be less than $0.001$. To find the appropriate $n$, consider the following inequalities:
\begin{align*}
\frac{\max\big|f\,^{(n+1)}(z)\big|}{(n+1)!}\big|(2-0)^{(n+1)}\big| &\leq 0.001 \\
\frac1{(n+1)!}\cdot2^{(n+1)} &\leq 0.001
\end{align*}
We find an $n$ that satisfies this last inequality with trial--and--error. When $n=8$, we have $\ds \frac{2^{8+1}}{(8+1)!} \approx 0.0014$; when $n=9$, we have $\ds \frac{2^{9+1}}{(9+1)!} \approx 0.000282 <0.001$. Thus we want to approximate $\cos 2$ with $p_9(2)$.\\

We now set out to compute $p_9(x)$. We again need a table of the derivatives of $f(x)=\cos x$ evaluated at $x=0$. A table of these values is given in Figure \ref{fig:taypoly4a}.
\mtable{.6}{A table of the derivatives of $f(x)=\cos x$ evaluated at $x=0$.}{fig:taypoly4a}{%
\begin{tabular}{lll}
$f(x) = \cos x $&$\Rightarrow $&$f(0) = 1$\\
$f'(x) = -\sin x $&$\Rightarrow $&$f'(0) = 0$\\
$f''(x) = -\cos x $&$\Rightarrow $&$f''(0) = -1$\\
$f'''(x) = \sin x $&$\Rightarrow $&$f'''(0) = 0$\\
$f\,^{(4)}(x) = \cos x $&$\Rightarrow $&$f\,^{(4)}(0) = 1$\\
$f\,^{(5)}(x) = -\sin x $&$\Rightarrow $&$f\,^{(5)}(0) = 0$\\
$f\,^{(6)}(x) = -\cos x $&$\Rightarrow $&$f\,^{(6)}(0) = -1$\\
$f\,^{(7)}(x) = \sin x $&$\Rightarrow $&$f\,^{(7)}(0) = 0$\\
$f\,^{(8)}(x) = \cos x $&$\Rightarrow $&$f\,^{(8)}(0) = 1$\\
$f\,^{(9)}(x) = -\sin x $&$\Rightarrow $&$f\,^{(9)}(0) = 0$
\end{tabular}
}
Notice how the derivatives, evaluated at $x=0$, follow a certain pattern. All the odd powers of $x$ in the Taylor polynomial will disappear as their coefficient is 0. While our error bounds state that we need $p_9(x)$, our work shows that this will be the same as $p_8(x)$. 

Since we are forming our polynomial at $x=0$, we are creating a Maclaurin polynomial, and :
\begin{align*}
p_8(x) &= f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + \cdots +\frac{f\,^{(8)}}{8!}x^8\\
		&=  1-\frac{1}{2!}x^2+\frac{1}{4!}x^4-\frac{1}{6!}x^6+\frac{1}{8!}x^8
\end{align*}

We finally approximate $\cos 2$:
$$\cos 2 \approx p_8(2) = -\frac{131}{315} \approx -0.41587.$$ Our error bound guarantee that this approximation is within $0.001$ of the correct answer. Technology shows us that our approximation is actually within about $0.0003$ of the correct answer.

Figure \ref{fig:taypoly4b} shows a graph of $y=p_8(x)$ and $y=\cos x$. Note how well the two functions agree on about $(-\pi,\pi)$.
\mfigure{.8}{A graph of $f(x)= \cos x$ and its degree 8 Maclaurin polynomial.}{fig:taypoly4b}{figures/figtaypoly4}
}\\

\example{ex_taypoly5}{Finding and using Taylor polynomials}{
\begin{enumerate}
					\item		Find the degree 4 Taylor polynomial, $p_4(x)$, for $f(x)=\sqrt{x}$ at $x=4.$
					\item		Use $p_4(x)$ to approximate $\sqrt{3}$.
					\item		Find bounds on the error when approximating $\sqrt{3}$ with $p_4(3)$.
					\end{enumerate}
}
{\begin{enumerate}
\item		We begin by evaluating the derivatives of $f$ at $x=4$. This is done in Figure \ref{fig:taypoly5a}.
\mtable{.55}{A table of the derivatives of $f(x)=\sqrt{x}$ evaluated at $x=4$.}{fig:taypoly5a}{%
\begin{tabular}{lll}
$f(x) = \sqrt{x} $&$\Rightarrow $&$f(4) = 2$\rule[-12pt]{0pt}{5pt}\\
$\dsf'(x) = \frac{1}{2\sqrt{x}} $&$\Rightarrow $&$\dsf'(4) = \frac{1}{4}$\rule[-12pt]{0pt}{5pt}\\
$\dsf''(x) = \frac{-1}{4x^{3/2}} $&$\Rightarrow $&$\dsf''(4) = \frac{-1}{32}$\rule[-12pt]{0pt}{5pt}\\
$\dsf'''(x) = \frac3{8x^{5/2}} $&$\Rightarrow $&$\dsf'''(4) = \frac{3}{256}$\rule[-12pt]{0pt}{5pt}\\
$\ds f\,^{(4)}(x) = \frac{-15}{16x^{7/2}} $&$\Rightarrow $&$\ds f\,^{(4)}(4) = \frac{-15}{2048}$
\end{tabular}
}
These values allow us to form the Taylor polynomial $p_4(x)$:
$$p_4(x) = 2 + \frac14(x-4) +\frac{-1/32}{2!}(x-4)^2+\frac{3/256}{3!}(x-4)^3+\frac{-15/2048}{4!}(x-4)^4.$$

\item		As $p_4(x) \approx \sqrt{x}$ near $x=4$, we approximate $\sqrt{3}$ with $p_4(3) = 1.73212$.
%\enlargethispage{3\baselineskip}

\item		To find a bound on the error, we need an open interval that contains $x=3$ and $x=4$. We set $I = (2.9,4.1)$. The largest value the fifth derivative of $f(x)=\sqrt{x}$ takes on this interval is near $x=2.9$, at about $0.0273$. Thus 
$$\big|R_4(3)\big| \leq \frac{0.0273}{5!}\big|(3-4)^5\big| \approx 0.00023.$$
This shows our approximation is accurate to at least the first 2 places after the decimal. (It turns out that our approximation is actually accurate to 4 places after the decimal.) A graph of $f(x)=\sqrt x$ and $p_4(x)$ is given in Figure \ref{fig:taypoly5b}. Note how the two functions are nearly indistinguishable on $(2,7)$.
\mfigure{.3}{A graph of $f(x)=\sqrt{x}$ and its degree 4 Taylor polynomial at $x=4$.}{fig:taypoly5b}{figures/figtaypoly5}
\end{enumerate}
\vskip-1.5\baselineskip
}\\
\clearpage

Our final example gives a brief introduction to using Taylor polynomials to solve differential equations.\\

\example{ex_taypoly6}{Approximating an unknown function}{
A function $y=f(x)$ is unknown save for the following two facts.
\begin{enumerate}
\item		$y(0) = f(0) = 1$, and
\item		$y'= y^2$
\end{enumerate}
(This second fact says that amazingly, the derivative of the function is actually the function squared!)

Find the degree 3 Maclaurin polynomial $p_3(x)$ of $y=f(x)$.
}
{One might initially think that not enough information is given to find $p_3(x)$. However, note how the second fact above actually lets us know what $y'(0)$ is:
$$y' = y^2 \Rightarrow y'(0) = y^2(0).$$
Since $y(0) = 1$, we conclude that $y'(0) = 1$.

%\drawexampleline
Now we find information about $y''$. Starting with $y'=y^2$, take derivatives of both sides, \emph{with respect to $x$}. That means we must use implicit differentiation.
\begin{align*}
y' &= y^2\\
\frac{d}{dx}(y') &= \frac{d}{dx}(y^2)\\
y'' &= 2y\cdot y'.
\intertext{Now evaluate both sides at $x=0$:}
y''(0) &= 2y(0)\cdot y'(0)\\
y''(0) &= 2
\end{align*}
We repeat this once more to find $y'''(0)$. We again use implicit differentiation; this time the Product Rule is also required.
\begin{align*}
\frac{d}{dx}(y'') &= \frac{d}{dx} (2yy')\\
y''' &= 2y'\cdot y' + 2y\cdot y''.
\intertext{Now evaluate both sides at $x=0$:}
y'''(0) &= 2y'(0)^2 + 2y(0)y''(0)\\
y'''(0) &=	2+4=6
\end{align*}
In summary, we have:
$$y(0) = 1 \qquad y'(0) = 1  \qquad y''(0) = 2 \qquad y'''(0) = 6.$$
We can now form $p_3(x)$:
\begin{align*}
p_3(x) &= 1 + x + \frac{2}{2!}x^2 + \frac{6}{3!}x^3\\
				&= 1+x+x^2+x^3.
\end{align*}
It turns out that the differential equation we started with, $y'=y^2$, where $y(0)=1$, can be solved without too much difficulty: $\ds y = \frac{1}{1-x}$. Figure \ref{fig:taypoly6} shows this function plotted with $p_3(x)$. Note how similar they are near $x=0$.
}\\

\mfigure{.8}{A graph of $y=-1/(x-1)$ and $y=p_3(x)$ from Example \ref{ex_taypoly6}.}{fig:taypoly6}{figures/figtaypoly6}
It is beyond the scope of this text to pursue error analysis when using Taylor polynomials to approximate solutions to differential equations. This topic is often broached in introductory Differential Equations courses and usually covered in depth in Numerical Analysis courses. Such an analysis is very important; one needs to know how good their approximation is. We explored this example simply to demonstrate the usefulness of Taylor polynomials. \\




\end{document}
